# МИР МИСиС - бэкенд - misis-schedule-back

Репозиторий содержит исходный код серверной части приложения "Мир МИСиС".

Приложение "Мир МИСиС" предназначено для просмотра расписания и получения другой информации о "НИТУ МИСиС".

Клиентское приложение получает данные из базы данных через бекенд, написанный на Python (фреймворк – FastAPI).

Данные из API МИСиС сохраняются в промежуточной базе данных, так как обращение к ней занимает значительно меньше времени, чем обращение к API МИСиС. Это ускоряет работу нашего приложения и снижает нагрузку на API МИСиС.

В качестве хранилища для промежуточного кеширования используется база данных MongoDb.

В ней есть следующие коллекции:
1. Users – список пользователей приложения.
2. Schedule – расписание для студентов. 
3. Schedule_teacher – также расписание, но для преподавателей.
4. Schedule_english – расписание по английскому.
5. Group_list – список учебных групп. 
6. English_group_list – список групп но английскому 
7. Teachers – список преподавателей. Данные берутся из API МИСиС.
8. Users_with_push – данные о настройках пушей для пользователей.

Записи в коллекции Schedule автоматически удаляются через 24 часа после добавления, сделано это для поддержания актуальности расписания в случае изменений. Данные для этой коллекции берутся и API МИСиС.

На бэкенде есть отдельный обработчик для актуализации данных об учебных группах в коллекции Group_list (данные берутся из API МИСиС).

Обычное расписание из API не предоставляет информацию о преподавателе и о номере кабинета для пар но английскому, поэтому эти данные парсятся из файлов GoogleSheets с расписанием, которые предоставляет кафедра иностранных языков МИСиС.

В МИСиС группы по английскому языку не совпадают с обычными учебными группами. На бэкенде есть отдельный обработчик для актуализации данных о группах по английскому в коллекции English_group_list (данные берутся из GoogleSheets).

Более подробную информацию о приложении см. https://github.com/kik-misis-ru/misis-schedule-front.git


## Запуск приложения

1. Клонирование репозитория:
  > git clone https://github.com/kik-misis-ru/misis-schedule-back.git
2. Создаём папку:
  > mkdir misis-back
2. Переходим в папку:
  > cd misis-back
3. Добавляем заполняем .env реальными данными.
4. Создаем виртуальное окружение:
  > python virtualenv venv
5. Активируем виртуальное окружение.
  > venv\Scripts\activate
6. Устанавливаем модули из файла requirements.txt:
  > pip install -r requirements.txt
7. Запускаем сервер (--reload - опционально):
  >uvicorn main:app --reload 
